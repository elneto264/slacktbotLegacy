let RTMClient,WebClient;_2bf‍.w("@slack/rtm-api",[["RTMClient",["RTMClient"],function(v){RTMClient=v}]]);_2bf‍.w("@slack/web-api",[["WebClient",["WebClient"],function(v){WebClient=v}]]);
// import { SLACK_OAUTH_TOKEN,BOT_SPAM_CHANNEL } from './constants'
const tokens = require('./constants')


const packageJson = require('../package.json')



const rtm = new RTMClient(tokens.SLACK_OAUTH_TOKEN);
const web = new WebClient(tokens.SLACK_OAUTH_TOKEN);

rtm.start()
    .catch(_2bf‍.g.console.error);

rtm.on('ready', async () =>{
    console.log('bot andando')
    enviarMensaje(BOT_SPAM_CHANNEL, `Robot version ${packageJson.version} esta activo`)
});

rtm.on('slack_event', async (eventType, event) =>{

    // console.log(eventType)
    // console.log(event)

    if( event && event.type === 'message'){
        if (event.text === 'hola'){
            hola(event.channel, event.user)
        }
    }

    if( event && event.type === 'message'){
        if (event.text === 'enlace'){
            enlace(event.channel, event.user)
        }
    }

    if( event && event.type === 'message'){
        if (event.text === 'excel'){
            hojaExcel(event.channel, event.user)
        }
    }

    if( event && event.type === 'message'){
        if (event.text === 'cuentame'){
            infocomandos(event.channel, event.user)
        }
    }


})

function infocomandos(channelId, userId){
    enviarMensaje(channelId, 
        `<@${userId}> 
        los comandos para informacion son: 
        enlace = reunion
        excel = documento excel para ver
        `)
}

function hojaExcel(channelId, userId){
    enviarMensaje(channelId, `<@${userId} aqui tienes el link para el excel: https://docs.google.com/spreadsheets/d/10iUCFIqy5Sn7oFuuknc0z3ITooyTu80PEigWcTv3CaI/edit?usp=sharing`)
}

function enlace(channelId, userId){
    enviarMensaje(channelId, `<@${userId}>este es el link de la reunion: https://meet.google.com/udr-ytcx-tdj`)
    
}

function hola(channelId, userId){
    enviarMensaje(channelId, `que tal <@${userId}>`)
}


async function enviarMensaje(channel, message){
    await web.chat.postMessage({
        channel: channel,
        text: message,
    });
}
